% Generated by roxygen2
\name{phyPVR}
\alias{phyPVR}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
Phylogenetic eigenvectors regression with lambda method.
}
\description{
The phylogenetic eigenvector regression (PVR) starts by performing an eigendecomposition of a pairwise double-centered phylogenetic distance matrix between species. The eigenvectors (representing the traits under analysis) estimated values express phylogenetic trends in data and residuals express independent evolution of each species.
}
\usage{
phyPVR(x, phy = NULL, trait = NULL, envVar = NULL, method = "lamdba", weights = NULL, scaled = FALSE, sig = TRUE, sig.t = 0.05, lamdba.t = 0.05, psr.t = 0.01, accvalue.t = 0.9, ...)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{x}{
An object of class PVR (created by the PVRdecomp function) or class PSR (requiered by the "PSR" method).
}
  \item{phy}{
An object of class phylo that contains an ultrametric phylogeny.
}
  \item{trait}{
A vector, data frame or matrix that contains traits sets (for data frames and matrices, each column must represent a trait set).
}
  \item{envVar}{
vector, data frame or matrix that contains environmental variables. Used to estimates the variation of a trait set that is explained by phylogeny and by environment.
}
  \item{method}{
Character string. A name for the eigenvectors selection method. It can be "lambda".
}

  \item{sig}{
Logical. Should the eigenvectors selected by the "lamdba" method be selected by the significance of residuals autocorrelation. If FALSE the eigenvectors will be selected by Moran's I values.
}
  \item{sig.t}{
The significance treshold used to select eigenvectors by the "lamdba" method.
}
  \item{lamdba.t}{
Minimum residuals lamdba value used to select eigenvectors when significance is FALSE.
}
  \item{psr.t}{
The minimum acumulate R2 gain treshold used to select eigenvectors by the "PSR" method.
}
  \item{accvalue.t}{
Relative accumulated eigenvalue treshold use to select the eigenvectors by the "sequential" method.
}
  \item{\dots}{
Parameters passed to the stepwise regression used in the "AIC" method
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{
%%  ~Describe the value returned
%%  If it is a LIST, use
%%  \item{comp1 }{Description of 'comp1'}
%%  \item{comp2 }{Description of 'comp2'}
%% ...
}
\references{
Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution, 52:1247-1262.

Keck, F., Rimet, F., Bouchez, A. and Franc, A. (2016), phylosignal: an R package to measure, test, and explore the phylogenetic signal. Ecol Evol, 6: 2774-2780. https://doi.org/10.1002/ece3.2051
}
\author{
Wuchao gao
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
library(PVR)
library(ape)
library(rdacca.hp)
library(phylosignal)
library(rr2phy)  
##Evaluate the relative importance of species trait in phylogeny and a single environment factor  
tree <- rcoal(10)
x <- PVRdecomp(tree)
trait <-  rnorm(10,1,0.01)
envvar <- rnorm(10,2,0.05)
phyPVR(x, trait = trait, envVar = envvar, method = "lambda")
}
##Evaluate the relative importance of species trait in phylogeny and multiple environment factors  
tree <- rcoal(10)  
x <- PVRdecomp(tree) trait <- rnorm(10,1,0.01)  
envvar <- matrix(rnorm(100,2,0.1), nrow = 10, ncol = 10)  
phyPVR(x, trait = trait, envVar = envvar, method = "lambda")  
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory (show via RShowDoc("KEYWORDS")):
% \keyword{ ~kwd1 }
% \keyword{ ~kwd2 }
% Use only one keyword per line.
% For non-standard keywords, use \concept instead of \keyword:
% \concept{ ~cpt1 }
% \concept{ ~cpt2 }
% Use only one concept per line.
